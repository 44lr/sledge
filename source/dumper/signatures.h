#pragma once

#include <unordered_map>

#include "util/memory.h"

#define Sig(cName, cPattern, cMask) { cName, new CSignature(cPattern, cMask) },
#define RawSig(cName, cPattern, cMask) { cName, new CSignature(cPattern, cMask, false) },

inline std::unordered_map<const char*, CSignature*> g_SigMap = {
	/*
		memory
	*/
	Sig("free", "\xE8\x00\x00\x00\x00\x4C\x39\x26", "x????xxx")
	Sig("alloc", "\xE8\x00\x00\x00\x00\xEB\x1F\x48\x85\xDB", "x????xxxxx")
	Sig("calloc", "\xE8\x00\x00\x00\x00\x33\xC9\x48\x8B\xE8", "x????xxxxx")
	Sig("realloc", "\xE8\x00\x00\x00\x00\x48\x8B\xF0\x48\x85\xC0\x74\x16", "x????xxxxxxxx")
	RawSig("memmove", "\x4C\x8B\xD9\x4C\x8B\xD2", "xxxxxx")

	/*
		registry
	*/
	Sig("SetBool", "\xE8\x00\x00\x00\x00\x90\x48\x8D\x4D\x87\xE8\x00\x00\x00\x00\x84\xDB", "x????xxxxxx????xx")
	Sig("SetInt", "\xE8\x00\x00\x00\x00\x90\x48\x8D\x4D\xE8\xE8\x00\x00\x00\x00\x33\xD2", "x????xxxxxx????xx")
	Sig("SetFloat", "\xE8\x00\x00\x00\x00\x48\x8D\x4D\x50", "x????xxxx")
	Sig("SetString", "\xE8\x00\x00\x00\x00\x90\xEB\x1F", "x????xxx")

	Sig("GetBool", "\xE8\x00\x00\x00\x00\x84\xC0\x74\x05\x40\xB6\x01", "x????xxxxxxx")
	Sig("GetInt", "\xE8\x00\x00\x00\x00\x89\x43\x2C", "x????xxx")
	Sig("GetFloat", "\xE8\x00\x00\x00\x00\xF3\x0F\x59\xF8", "x????xxxx")
	RawSig("GetString", "\x40\x53\x48\x83\xEC\x30\x49\x8B\xC0", "xxxxxxxxx")

	/*
		tags
	*/
	RawSig("SetTag", "\x4C\x89\x44\x24\x00\x57\x41\x56", "xxxx?xxx")
	Sig("HasTag", "\xE8\x00\x00\x00\x00\x0F\xB6\xD8\x48\x8D\x4D\x90", "x????xxxxxxx")
	RawSig("RemoveTag", "\x40\x53\x41\x56\x48\x83\xEC\x58\xF6\x41\x0A\x01", "xxxxxxxxxxxx")
	Sig("GetTag", "\xE8\x00\x00\x00\x00\x90\x48\x8B\xC8\xE8\x00\x00\x00\x00\x41\x0F\x2E\xC2", "x????xxxxx????xxxx")

	/*
		constructors
	*/
	Sig("CGame", "\xE8\x00\x00\x00\x00\x48\x8B\xF8\xEB\x02\x33\xFF\x48\x8D\x4D\xA7", "x????xxxxxxxxxxx")

	Sig("CBody", "\xE8\x00\x00\x00\x00\x48\x8B\xF8\x33\xDB", "x????xxxxx")
	Sig("CShape", "\xE8\x00\x00\x00\x00\x48\x8B\xF8\x48\x89\x7D\xA0", "x????xxxxxxx")

	/*
		misc
	*/
	RawSig("Log", "\x80\x79\x0F\x00\x74\x03\x48\x8B\x09\x48\x8B\xD1\x48\x8D\x0D\x00\x00\x00\x00", "xxxxxxxxxxxxxxx????")
};